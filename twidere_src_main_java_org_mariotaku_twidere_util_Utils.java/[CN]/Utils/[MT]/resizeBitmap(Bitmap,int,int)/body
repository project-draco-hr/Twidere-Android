{
  final int width=orig.getWidth();
  final int height=orig.getHeight();
  if (0 < width && 0 < height && desireWidth < width || desireHeight < height) {
    float scale;
    if (width < height) {
      scale=(float)desireHeight / (float)height;
      if (desireWidth < width * scale) {
        scale=(float)desireWidth / (float)width;
      }
    }
 else {
      scale=(float)desireWidth / (float)width;
    }
    final Matrix matrix=new Matrix();
    matrix.postScale(scale,scale);
    final Bitmap bitmap=Bitmap.createBitmap(orig,0,0,width,height,matrix,true);
    final Canvas canvas=new Canvas(bitmap);
    canvas.drawBitmap(bitmap,0,0,null);
    orig=bitmap;
  }
  return orig;
}
