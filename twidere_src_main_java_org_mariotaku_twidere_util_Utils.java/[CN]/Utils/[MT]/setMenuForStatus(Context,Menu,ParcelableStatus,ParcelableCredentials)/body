{
  if (context == null || menu == null || status == null)   return;
  final Resources resources=context.getResources();
  final int retweetHighlight=resources.getColor(R.color.highlight_retweet);
  final int favoriteHighlight=resources.getColor(R.color.highlight_favorite);
  final boolean isMyRetweet=isMyRetweet(status);
  final MenuItem delete=menu.findItem(MENU_DELETE);
  if (delete != null) {
    delete.setVisible(status.account_id == status.user_id && !isMyRetweet);
  }
  final MenuItem retweet=menu.findItem(MENU_RETWEET);
  if (retweet != null) {
    retweet.setVisible(!status.user_is_protected || isMyRetweet);
    MenuUtils.setMenuInfo(retweet,new TwidereMenuInfo(isMyRetweet,retweetHighlight));
    retweet.setTitle(isMyRetweet ? R.string.cancel_retweet : R.string.retweet);
  }
  final MenuItem retweetSubItem=menu.findItem(R.id.retweet_submenu);
  if (retweetSubItem != null) {
    MenuUtils.setMenuInfo(retweetSubItem,new TwidereMenuInfo(isMyRetweet,retweetHighlight));
  }
  final MenuItem favorite=menu.findItem(MENU_FAVORITE);
  if (favorite != null) {
    MenuUtils.setMenuInfo(favorite,new TwidereMenuInfo(status.is_favorite,favoriteHighlight));
    favorite.setTitle(status.is_favorite ? R.string.unfavorite : R.string.favorite);
  }
  final MenuItem translate=menu.findItem(MENU_TRANSLATE);
  if (translate != null) {
    final boolean isOfficialKey=isOfficialCredentials(context,account);
    setMenuItemAvailability(menu,MENU_TRANSLATE,isOfficialKey);
  }
  menu.removeGroup(MENU_GROUP_STATUS_EXTENSION);
  addIntentToMenuForExtension(context,menu,MENU_GROUP_STATUS_EXTENSION,INTENT_ACTION_EXTENSION_OPEN_STATUS,EXTRA_STATUS,EXTRA_STATUS_JSON,status);
  final MenuItem shareItem=menu.findItem(R.id.share);
  final ActionProvider shareProvider=shareItem.getActionProvider();
  if (shareProvider instanceof StatusShareProvider) {
    ((StatusShareProvider)shareProvider).setStatus(status);
  }
 else {
    if (shareItem.hasSubMenu()) {
      final Menu shareSubMenu=shareItem.getSubMenu();
      final Intent shareIntent=createStatusShareIntent(context,status);
      shareSubMenu.removeGroup(MENU_GROUP_STATUS_SHARE);
      addIntentToMenu(context,shareSubMenu,shareIntent,MENU_GROUP_STATUS_SHARE);
    }
  }
}
