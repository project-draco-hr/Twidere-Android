{
  final byte[] input=new byte[32];
  secureRandom.nextBytes(input);
  final String encodedString=Base64.encodeToString(input,Base64.URL_SAFE);
  if (encodedString == null) {
    throw new IllegalStateException("Bad nonce " + Utils.bytesToHex(input));
  }
  return encodedString.replaceAll("[^\\w\\d]","");
}
