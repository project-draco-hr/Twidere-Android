{
  final byte[] input=new byte[32];
  secureRandom.nextBytes(input);
  final ByteString byteString=ByteString.of(input);
  final String encodedString=byteString.base64Url();
  if (encodedString == null) {
    throw new IllegalStateException("Bad nonce " + byteString.hex());
  }
  return encodedString.replaceAll("[^\\w\\d]","");
}
