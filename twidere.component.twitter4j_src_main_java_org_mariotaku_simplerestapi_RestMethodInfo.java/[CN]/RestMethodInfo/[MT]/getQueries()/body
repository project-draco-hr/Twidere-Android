{
  if (queriesCache != null)   return queriesCache;
  final ArrayList<Pair<String,String>> list=new ArrayList<>();
  for (  Map.Entry<Query,Object> entry : queries.entrySet()) {
    final Query form=entry.getKey();
    final Object value=entry.getValue();
    if (value == null)     continue;
    if (value instanceof ValueMap) {
      final ValueMap valueMap=(ValueMap)value;
      for (      String key : getValueMapKeys(form.value(),valueMap)) {
        if (valueMap.has(key)) {
          list.add(Pair.create(key,String.valueOf(valueMap.get(key))));
        }
      }
    }
 else {
      final char delimiter=form.arrayDelimiter();
      String valueString=Utils.toString(value,delimiter);
      for (      String key : form.value()) {
        list.add(Pair.create(key,valueString));
      }
    }
  }
  return queriesCache=list;
}
