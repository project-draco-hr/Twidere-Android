{
  if (extrasCache != null)   return extrasCache;
  final Map<String,Object> map=new HashMap<>();
  for (  Map.Entry<Extra,Object> entry : extras.entrySet()) {
    final Extra extra=entry.getKey();
    final Object value=entry.getValue();
    if (value instanceof ValueMap) {
      final ValueMap valueMap=(ValueMap)value;
      for (      String key : extra.value()) {
        if (valueMap.has(key)) {
          map.put(key,valueMap.get(key));
        }
      }
    }
 else     if (value != null) {
      for (      String key : extra.value()) {
        map.put(key,value);
      }
    }
  }
  return extrasCache=map;
}
