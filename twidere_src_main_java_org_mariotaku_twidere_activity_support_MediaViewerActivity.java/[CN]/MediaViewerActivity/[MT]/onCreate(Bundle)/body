{
  super.onCreate(savedInstanceState);
  mActionBar=getSupportActionBar();
  mActionBar.setDisplayHomeAsUpEnabled(true);
  setContentView(R.layout.activity_media_viewer);
  mAdapter=new MediaPagerAdapter(this);
  mViewPager.setAdapter(mAdapter);
  mViewPager.setPageMargin(getResources().getDimensionPixelSize(R.dimen.element_spacing_normal));
  mViewPager.setOnPageChangeListener(this);
  final Intent intent=getIntent();
  final long accountId=intent.getLongExtra(EXTRA_ACCOUNT_ID,-1);
  final ParcelableMedia[] media=Utils.newParcelableArray(intent.getParcelableArrayExtra(EXTRA_MEDIA),ParcelableMedia.CREATOR);
  final ParcelableMedia currentMedia=intent.getParcelableExtra(EXTRA_CURRENT_MEDIA);
  mAdapter.setMedia(accountId,media);
  final int currentIndex=ArrayUtils.indexOf(media,currentMedia);
  if (currentIndex != -1) {
    mViewPager.setCurrentItem(currentIndex,false);
  }
  if (intent.hasExtra(EXTRA_STATUS)) {
    mMediaStatusContainer.setVisibility(View.VISIBLE);
    final FragmentTransaction ft=getSupportFragmentManager().beginTransaction();
    final Fragment f=new ViewStatusDialogFragment();
    final Bundle args=new Bundle();
    args.putParcelable(EXTRA_STATUS,intent.getParcelableExtra(EXTRA_STATUS));
    args.putBoolean(EXTRA_SHOW_MEDIA_PREVIEW,false);
    args.putBoolean(EXTRA_SHOW_EXTRA_TYPE,false);
    f.setArguments(args);
    ft.replace(R.id.media_status,f);
    ft.commit();
  }
 else {
    mMediaStatusContainer.setVisibility(View.GONE);
  }
}
