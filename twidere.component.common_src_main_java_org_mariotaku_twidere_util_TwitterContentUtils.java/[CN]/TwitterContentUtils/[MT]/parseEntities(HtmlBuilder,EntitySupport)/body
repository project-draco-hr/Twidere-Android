{
  final MediaEntity[] mediaEntities=entities.getMediaEntities();
  if (mediaEntities != null) {
    for (    final MediaEntity mediaEntity : mediaEntities) {
      final int start=mediaEntity.getStart(), end=mediaEntity.getEnd();
      final String mediaUrl=mediaEntity.getMediaURL();
      if (mediaUrl != null && start >= 0 && end >= 0) {
        builder.addLink(mediaUrl,mediaEntity.getDisplayURL(),start,end);
      }
    }
  }
  final URLEntity[] urlEntities=entities.getURLEntities();
  if (urlEntities != null) {
    for (    final URLEntity urlEntity : urlEntities) {
      final int start=urlEntity.getStart(), end=urlEntity.getEnd();
      final String expandedUrl=urlEntity.getExpandedURL();
      if (expandedUrl != null && start >= 0 && end >= 0) {
        builder.addLink(expandedUrl,urlEntity.getDisplayURL(),start,end);
      }
    }
  }
}
