{
  final MediaEntity[] mediaEntities=entities.getMediaEntities();
  if (mediaEntities != null) {
    for (    final MediaEntity mediaEntity : mediaEntities) {
      final int start=mediaEntity.getStart(), end=mediaEntity.getEnd();
      final String mediaUrl=TwitterContentUtils.getMediaUrl(mediaEntity);
      if (mediaUrl != null && start >= 0 && end >= 0) {
        builder.addLink(mediaUrl,mediaEntity.getDisplayUrl(),start,end);
      }
    }
  }
  final UrlEntity[] urlEntities=entities.getUrlEntities();
  if (urlEntities != null) {
    for (    final UrlEntity urlEntity : urlEntities) {
      final int start=urlEntity.getStart(), end=urlEntity.getEnd();
      final String expandedUrl=urlEntity.getExpandedUrl();
      if (expandedUrl != null && start >= 0 && end >= 0) {
        builder.addLink(expandedUrl,urlEntity.getDisplayUrl(),start,end);
      }
    }
  }
}
