{
  final int measuredWidth=resolveSize(getSuggestedMinimumWidth(),widthMeasureSpec);
  final int contentWidth=measuredWidth - getPaddingLeft() - getPaddingRight();
  final int[] childIndices=createChildIndices();
  final int childCount=getChildIndicesInLayout(this,childIndices);
  int heightSum=0;
  if (childCount > 0) {
    if (childCount == 1) {
      measure1Media(contentWidth,childIndices);
      heightSum=Math.round(contentWidth * WIDTH_HEIGHT_RATIO);
    }
 else     if (childCount == 2) {
      measureGridMedia(childCount,2,contentWidth,1,mHorizontalSpacing,mVerticalSpacing,childIndices);
      heightSum=Math.round(contentWidth * WIDTH_HEIGHT_RATIO);
    }
 else     if (childCount == 3) {
      measure3Media(contentWidth,mHorizontalSpacing,childIndices);
      heightSum=Math.round(contentWidth * WIDTH_HEIGHT_RATIO);
    }
 else {
      heightSum=measureGridMedia(childCount,2,contentWidth,WIDTH_HEIGHT_RATIO,mHorizontalSpacing,mVerticalSpacing,childIndices);
    }
  }
  final int height=heightSum + getPaddingTop() + getPaddingBottom();
  setMeasuredDimension(widthMeasureSpec,MeasureSpec.makeMeasureSpec(height,MeasureSpec.EXACTLY));
}
