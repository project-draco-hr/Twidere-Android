{
  final boolean hasMedia=hasMedia();
  final MenuItem itemAttachLocation=menu.findItem(MENU_ADD_LOCATION);
  if (itemAttachLocation != null) {
    final boolean attachLocation=mPreferences.getBoolean(KEY_ATTACH_LOCATION,false);
    if (attachLocation && getLocation()) {
      itemAttachLocation.setChecked(true);
    }
 else {
      setProgressVisibility(false);
      mPreferences.edit().putBoolean(KEY_ATTACH_LOCATION,false).apply();
      itemAttachLocation.setChecked(false);
    }
  }
  final MenuItem viewItem=menu.findItem(MENU_VIEW);
  if (viewItem != null) {
    viewItem.setVisible(mInReplyToStatus != null);
  }
  menu.setGroupEnabled(MENU_GROUP_IMAGE_EXTENSION,hasMedia);
  menu.setGroupVisible(MENU_GROUP_IMAGE_EXTENSION,hasMedia);
  final MenuItem itemToggleSensitive=menu.findItem(MENU_TOGGLE_SENSITIVE);
  if (itemToggleSensitive != null) {
    itemToggleSensitive.setVisible(hasMedia);
    itemToggleSensitive.setEnabled(hasMedia);
    itemToggleSensitive.setChecked(hasMedia && mIsPossiblySensitive);
  }
}
