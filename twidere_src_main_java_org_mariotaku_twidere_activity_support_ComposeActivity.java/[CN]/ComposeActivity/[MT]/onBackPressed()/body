{
  if (mTask != null && mTask.getStatus() == AsyncTask.Status.RUNNING)   return;
  final String option=mPreferences.getString(KEY_COMPOSE_QUIT_ACTION,VALUE_COMPOSE_QUIT_ACTION_ASK);
  final String text=mEditText != null ? ParseUtils.parseString(mEditText.getText()) : null;
  final boolean textChanged=text != null && !text.isEmpty() && !text.equals(mOriginalText);
  final boolean isEditingDraft=INTENT_ACTION_EDIT_DRAFT.equals(getIntent().getAction());
  if (VALUE_COMPOSE_QUIT_ACTION_DISCARD.equals(option)) {
    mTask=new DiscardTweetTask(this).execute();
  }
 else   if (textChanged || hasMedia() || isEditingDraft) {
    if (VALUE_COMPOSE_QUIT_ACTION_SAVE.equals(option)) {
      saveToDrafts();
      Toast.makeText(this,R.string.status_saved_to_draft,Toast.LENGTH_SHORT).show();
      finish();
    }
 else {
      new UnsavedTweetDialogFragment().show(getSupportFragmentManager(),"unsaved_tweet");
    }
  }
 else {
    mTask=new DiscardTweetTask(this).execute();
  }
}
