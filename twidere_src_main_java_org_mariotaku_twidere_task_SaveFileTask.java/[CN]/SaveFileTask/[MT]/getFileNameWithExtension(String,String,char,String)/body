{
  StringBuilder sb=new StringBuilder();
  int end=name.length();
  if (extension != null) {
    if (name.endsWith(extension)) {
      for (int i=end - extension.length() - 1; i >= 0; i--) {
        if (name.charAt(i) != specialCharacter) {
          end=i + 1;
          break;
        }
      }
    }
  }
  sb.append(name,0,end);
  if (suffix != null) {
    sb.append(suffix);
  }
  if (extension != null) {
    sb.append('.');
    sb.append(extension);
  }
  return sb.toString();
}
