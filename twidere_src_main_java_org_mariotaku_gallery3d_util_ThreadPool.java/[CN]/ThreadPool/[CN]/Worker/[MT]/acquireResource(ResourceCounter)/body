{
  while (true) {
synchronized (this) {
      if (mIsCancelled) {
        mWaitOnResource=null;
        return false;
      }
      mWaitOnResource=counter;
    }
synchronized (counter) {
      if (counter.value > 0) {
        counter.value--;
        break;
      }
 else {
        try {
          counter.wait();
        }
 catch (        final InterruptedException ex) {
        }
      }
    }
  }
synchronized (this) {
    mWaitOnResource=null;
  }
  return true;
}
