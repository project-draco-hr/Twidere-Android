{
  if (shortener == null)   return;
  stateCallback.onShorteningStatus();
  Map<UserKey,StatusShortenResult> sharedShortened=new HashMap<>();
  for (int i=0; i < pending.length; i++) {
    ParcelableAccount account=update.accounts[i];
    final UserKey accountKey=account.account_key;
    StatusShortenResult shortenResult=sharedShortened.get(accountKey);
    if (shortenResult == null) {
      shortenResult=shortener.shorten(update,accountKey,pending.overrideTexts[i]);
      if (shortenResult == null) {
        continue;
      }
      pending.statusShortenResults[i]=shortenResult;
      if (shortenResult.shared_owners != null) {
        for (        UserKey sharedOwner : shortenResult.shared_owners) {
          sharedShortened.put(sharedOwner,shortenResult);
        }
      }
    }
    pending.overrideTexts[i]=shortenResult.shortened;
  }
}
