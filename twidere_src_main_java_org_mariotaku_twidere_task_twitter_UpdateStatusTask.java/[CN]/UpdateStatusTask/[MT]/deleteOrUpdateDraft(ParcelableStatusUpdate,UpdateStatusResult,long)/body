{
  final String where=Expression.equalsArgs(Drafts._ID).getSQL();
  final String[] whereArgs={String.valueOf(draftId)};
  boolean hasError=false;
  List<UserKey> failedAccounts=new ArrayList<>();
  for (int i=0; i < update.accounts.length; i++) {
    Exception exception=result.exceptions[i];
    if (exception != null && !isDuplicate(exception)) {
      hasError=true;
      failedAccounts.add(update.accounts[i].account_key);
    }
  }
  final ContentResolver cr=context.getContentResolver();
  if (hasError) {
    ContentValues values=new ContentValues();
    values.put(Drafts.ACCOUNT_KEYS,CollectionUtils.toString(failedAccounts,',',false));
    cr.update(Drafts.CONTENT_URI,values,where,whereArgs);
  }
 else {
    cr.delete(Drafts.CONTENT_URI,where,whereArgs);
  }
}
