{
  final boolean result=super.onPrepareOptionsMenu(menu);
  if (!shouldSetActionItemColor())   return result;
  final View actionBarView=getWindow().findViewById(android.support.v7.appcompat.R.id.action_bar);
  if (actionBarView instanceof Toolbar) {
    final int themeColor=getCurrentThemeColor();
    final int themeId=getCurrentThemeResourceId();
    final int itemColor=ThemeUtils.getContrastActionBarItemColor(this,themeId,themeColor);
    final Toolbar toolbar=(Toolbar)actionBarView;
    ThemeUtils.setActionBarOverflowColor(toolbar,itemColor);
    final int popupColor=ThemeUtils.getThemeForegroundColor(toolbar.getContext(),toolbar.getPopupTheme());
    ThemeUtils.wrapToolbarMenuIcon(ViewUtils.findViewByType(actionBarView,ActionMenuView.class),itemColor,popupColor);
  }
  return result;
}
