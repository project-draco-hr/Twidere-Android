{
  if (out == null)   throw new IllegalArgumentException("The Writer must not be null");
  if (input == null)   return;
  int pos=0;
  final int len=input.length();
  while (pos < len) {
    final int consumed=translate(input,pos,out);
    if (consumed == 0) {
      final char[] c=Character.toChars(Character.codePointAt(input,pos));
      out.write(c);
      pos+=c.length;
      continue;
    }
    for (int pt=0; pt < consumed; pt++) {
      pos+=Character.charCount(Character.codePointAt(input,pos));
    }
  }
}
