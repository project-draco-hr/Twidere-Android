{
  if (mSaveToStoragePosition == -1)   return;
  final ViewPager viewPager=findViewPager();
  final PagerAdapter adapter=viewPager.getAdapter();
  final Object object=adapter.instantiateItem(viewPager,mSaveToStoragePosition);
  if (!(object instanceof CacheDownloadMediaViewerFragment))   return;
  final CacheDownloadMediaViewerFragment f=(CacheDownloadMediaViewerFragment)object;
  final CacheDownloadLoader.Result result=f.getDownloadResult();
  if (result == null)   return;
  final Uri cacheUri=result.cacheUri;
  final boolean hasMedia=cacheUri != null;
  if (!hasMedia)   return;
  SaveFileTask task;
  if (f instanceof ImagePageFragment) {
    task=SaveMediaToGalleryTask.create(this,cacheUri,CacheProvider.Type.IMAGE);
  }
 else   if (f instanceof VideoPageFragment) {
    task=SaveMediaToGalleryTask.create(this,cacheUri,CacheProvider.Type.VIDEO);
  }
 else   if (f instanceof GifPageFragment) {
    task=SaveMediaToGalleryTask.create(this,cacheUri,CacheProvider.Type.IMAGE);
  }
 else {
    throw new UnsupportedOperationException();
  }
  AsyncTaskUtils.executeTask(task);
}
