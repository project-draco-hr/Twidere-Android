{
  super.onActivityCreated(savedInstanceState);
  mPreferences=getSharedPreferences(SHARED_PREFERENCES_NAME,Context.MODE_PRIVATE);
  mResolver=getContentResolver();
  final Context context=getView().getContext();
  mImageLoader=TwidereApplication.getInstance(context).getImageLoaderWrapper();
  final LayoutInflater inflater=LayoutInflater.from(context);
  final ListView listView=getListView();
  mAdapter=new MergeAdapter();
  mAccountsAdapter=new AccountSelectorAdapter(context,this);
  mAccountOptionsAdapter=new AccountOptionsAdapter(context);
  mAppMenuAdapter=new AppMenuAdapter(context);
  mAppMenuSectionView=newSectionView(context,R.string.more);
  mAccountSelectorView=inflater.inflate(R.layout.header_drawer_account_selector,listView,false);
  mAccountsSelector=(RecyclerView)mAccountSelectorView.findViewById(R.id.other_accounts_list);
  final LinearLayoutManager layoutManager=new LinearLayoutManager(context,LinearLayoutManager.HORIZONTAL,false);
  layoutManager.setStackFromEnd(true);
  mAccountsSelector.setLayoutManager(layoutManager);
  mAccountsSelector.setAdapter(mAccountsAdapter);
  mAccountProfileContainer=mAccountSelectorView.findViewById(R.id.profile_container);
  mAccountProfileImageView=(ImageView)mAccountSelectorView.findViewById(R.id.profile_image);
  mAccountProfileBannerView=(ImageView)mAccountSelectorView.findViewById(R.id.account_profile_banner);
  mAccountProfileNameView=(TextView)mAccountSelectorView.findViewById(R.id.name);
  mAccountProfileScreenNameView=(TextView)mAccountSelectorView.findViewById(R.id.screen_name);
  mAccountsToggle=(Switch)mAccountSelectorView.findViewById(R.id.toggle);
  mAccountsToggle.setOnCheckedChangeListener(this);
  mAdapter.addView(mAccountSelectorView,false);
  mAdapter.addAdapter(mAccountOptionsAdapter);
  mAdapter.addView(mAppMenuSectionView,false);
  mAdapter.addAdapter(mAppMenuAdapter);
  setListAdapter(mAdapter);
  mPreferences.registerOnSharedPreferenceChangeListener(this);
  getLoaderManager().initLoader(0,null,this);
}
