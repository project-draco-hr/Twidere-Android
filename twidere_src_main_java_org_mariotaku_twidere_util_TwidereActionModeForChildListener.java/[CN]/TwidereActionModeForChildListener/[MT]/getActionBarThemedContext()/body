{
  final TypedValue outValue=new TypedValue();
  final Resources.Theme baseTheme=mActivity.getTheme();
  baseTheme.resolveAttribute(android.support.v7.appcompat.R.attr.actionBarTheme,outValue,true);
  if (outValue.resourceId != 0) {
    final Resources.Theme actionBarTheme=mActivity.getResources().newTheme();
    actionBarTheme.setTo(baseTheme);
    actionBarTheme.applyStyle(outValue.resourceId,true);
    final Context actionBarContext=new ContextThemeWrapper(mActivity,0);
    actionBarContext.getTheme().setTo(actionBarTheme);
    return actionBarContext;
  }
 else {
    return mActivity;
  }
}
