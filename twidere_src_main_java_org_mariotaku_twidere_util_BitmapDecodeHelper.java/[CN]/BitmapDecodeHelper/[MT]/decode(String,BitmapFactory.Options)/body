{
  if (path == null || opts == null)   return null;
  final Bitmap bm=BitmapFactory.decodeFile(path,opts);
  if (bm == null)   return null;
  final Matrix m=new Matrix();
  final int orientation=Exif.getOrientation(path);
switch (orientation) {
case 270:
case 90:
    m.postRotate(orientation);
  return Bitmap.createBitmap(bm,0,0,bm.getWidth(),bm.getHeight(),m,true);
case 180:
m.postRotate(orientation);
m.postScale(bm.getWidth(),bm.getHeight());
return Bitmap.createBitmap(bm,0,0,bm.getWidth(),bm.getHeight(),m,true);
}
return bm;
}
