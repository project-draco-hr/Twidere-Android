{
  final TypedValue outValue=new TypedValue();
  if (!context.getTheme().resolveAttribute(attr,outValue,true))   return def;
  if (outValue.type == TypedValue.TYPE_REFERENCE)   return ContextCompat.getColor(context,attr);
  return outValue.data;
}
