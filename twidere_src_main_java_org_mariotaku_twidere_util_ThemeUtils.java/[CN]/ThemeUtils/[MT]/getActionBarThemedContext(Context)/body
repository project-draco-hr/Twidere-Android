{
  final TypedValue outValue=new TypedValue();
  final Resources.Theme baseTheme=base.getTheme();
  baseTheme.resolveAttribute(android.support.v7.appcompat.R.attr.actionBarTheme,outValue,true);
  if (outValue.resourceId != 0) {
    final Resources.Theme actionBarTheme=base.getResources().newTheme();
    actionBarTheme.setTo(baseTheme);
    actionBarTheme.applyStyle(outValue.resourceId,true);
    final ActionBarContextThemeWrapper actionBarContext=new ActionBarContextThemeWrapper(base,outValue.resourceId);
    actionBarContext.getTheme().setTo(actionBarTheme);
    return actionBarContext;
  }
 else {
    return base;
  }
}
