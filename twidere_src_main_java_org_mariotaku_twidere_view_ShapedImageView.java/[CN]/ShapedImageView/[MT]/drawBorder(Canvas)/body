{
  final RectF transitionSrc=mTransitionSource, transitionDst=mTransitionDestination;
  if (transitionSrc != null && transitionDst != null) {
    final float progress=1 - (mDestination.width() - transitionDst.width()) / (transitionSrc.width() - transitionDst.width());
    mBorderPaint.setStrokeWidth(mStrokeWidth * progress);
    mBorderPaint.setAlpha(Math.round(mBorderAlpha * progress));
    ViewCompat.setTranslationZ(this,-ViewCompat.getElevation(this) * (1 - progress));
  }
 else {
    mBorderPaint.setStrokeWidth(mStrokeWidth);
    mBorderPaint.setAlpha(mBorderAlpha);
    ViewCompat.setTranslationZ(this,0);
  }
  if (getStyle() == SHAPE_CIRCLE) {
    canvas.drawCircle(mDestination.centerX(),mDestination.centerY(),mDestination.width() / 2f - mBorderPaint.getStrokeWidth() / 2,mBorderPaint);
  }
 else {
    final float radius=getCalculatedCornerRadius();
    canvas.drawRoundRect(mDestination,radius,radius,mBorderPaint);
  }
}
