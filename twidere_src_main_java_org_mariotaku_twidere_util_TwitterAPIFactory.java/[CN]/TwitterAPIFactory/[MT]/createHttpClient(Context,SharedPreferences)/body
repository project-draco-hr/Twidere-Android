{
  final int connectionTimeout=prefs.getInt(KEY_CONNECTION_TIMEOUT,10);
  final boolean ignoreSslError=prefs.getBoolean(KEY_IGNORE_SSL_ERROR,false);
  final boolean enableProxy=prefs.getBoolean(KEY_ENABLE_PROXY,false);
  final OkHttpClient client=new OkHttpClient();
  client.setConnectTimeout(connectionTimeout,TimeUnit.SECONDS);
  if (ignoreSslError) {
    client.setSslSocketFactory(SSLCertificateSocketFactory.getInsecure(0,null));
  }
 else {
    client.setSslSocketFactory(SSLCertificateSocketFactory.getDefault(0,null));
  }
  if (enableProxy) {
    client.setProxy(getProxy(prefs));
  }
  Internal.instance.setNetwork(client,TwidereApplication.getInstance(context).getNetwork());
  return new OkHttpRestClient(context,client);
}
