{
  final int color;
  final Bundle args=getArguments();
  if (savedInstanceState != null) {
    color=savedInstanceState.getInt(EXTRA_COLOR,Color.WHITE);
  }
 else {
    color=args.getInt(EXTRA_COLOR,Color.WHITE);
  }
  final boolean showAlphaSlider=args.getBoolean(EXTRA_ALPHA_SLIDER,true);
  final ColorPickerDialog d=new ColorPickerDialog(getActivity(),color,showAlphaSlider);
  d.setButton(DialogInterface.BUTTON_POSITIVE,getString(android.R.string.ok),this);
  if (args.getBoolean(EXTRA_CLEAR_BUTTON,false)) {
    d.setButton(DialogInterface.BUTTON_NEUTRAL,getString(R.string.clear),this);
  }
  d.setButton(DialogInterface.BUTTON_NEGATIVE,getString(android.R.string.cancel),this);
  return d;
}
