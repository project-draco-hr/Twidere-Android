{
  final String[] userProjection={Statuses.USER_ID,Statuses.USER_NAME,Statuses.USER_SCREEN_NAME};
  final Cursor userCursor=mDatabaseWrapper.query(Mentions.TABLE_NAME,userProjection,filteredSelection,null,Statuses.USER_ID,null,Statuses.SORT_ORDER_TIMESTAMP_DESC,"1");
  try {
    final int usersCount=DatabaseQueryUtils.count(mDatabaseWrapper.getSQLiteDatabase(),Mentions.TABLE_NAME,filteredSelection,null,Statuses.USER_ID,null,null);
    if (statusesCount == 0 || usersCount == 0)     return;
    final String accountName=Utils.getAccountName(context,accountId);
    final String accountScreenName=Utils.getAccountScreenName(context,accountId);
    final int idxStatusText=statusCursor.getColumnIndex(Statuses.TEXT_UNESCAPED), idxStatusId=statusCursor.getColumnIndex(Statuses.STATUS_ID), idxStatusTimestamp=statusCursor.getColumnIndex(Statuses.STATUS_TIMESTAMP), idxStatusUserId=statusCursor.getColumnIndex(Statuses.USER_ID), idxStatusUserName=statusCursor.getColumnIndex(Statuses.USER_NAME), idxStatusUserScreenName=statusCursor.getColumnIndex(Statuses.USER_SCREEN_NAME), idxStatusUserFollowing=statusCursor.getColumnIndex(Statuses.IS_FOLLOWING), idxUserName=userCursor.getColumnIndex(Statuses.USER_NAME), idxUserScreenName=userCursor.getColumnIndex(Statuses.USER_SCREEN_NAME), idxUserId=userCursor.getColumnIndex(Statuses.USER_ID);
    final CharSequence notificationTitle=resources.getQuantityString(R.plurals.N_new_mentions,statusesCount,statusesCount);
    final String notificationContent;
    userCursor.moveToFirst();
    final String displayName=mUserColorNameManager.getUserNickname(userCursor.getLong(idxUserId),mNameFirst ? userCursor.getString(idxUserName) : userCursor.getString(idxUserScreenName));
    if (usersCount == 1) {
      notificationContent=context.getString(R.string.notification_mention,displayName);
    }
 else {
      notificationContent=context.getString(R.string.notification_mention_multiple,displayName,usersCount - 1);
    }
    long when=-1, statusId=-1;
    boolean following=false;
    final InboxStyle style=new InboxStyle();
    for (int i=0, j=Math.min(statusCursor.getCount(),5); statusCursor.moveToPosition(i) && i < j; i++) {
      if (when == -1) {
        when=statusCursor.getLong(idxStatusTimestamp);
      }
      if (statusId == -1) {
        statusId=statusCursor.getLong(idxStatusId);
        following=statusCursor.getShort(idxStatusUserFollowing) == 1;
      }
      final SpannableStringBuilder sb=new SpannableStringBuilder();
      sb.append(mUserColorNameManager.getUserNickname(statusCursor.getLong(idxStatusUserId),mNameFirst ? statusCursor.getString(idxStatusUserName) : statusCursor.getString(idxStatusUserScreenName)));
      sb.setSpan(new StyleSpan(Typeface.BOLD),0,sb.length(),Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
      sb.append(' ');
      sb.append(statusCursor.getString(idxStatusText));
      style.addLine(sb);
    }
    if (mNameFirst) {
      style.setSummaryText(accountName);
    }
 else {
      style.setSummaryText("@" + accountScreenName);
    }
    final NotificationCompat.Builder builder=new NotificationCompat.Builder(context);
    builder.setAutoCancel(true);
    builder.setSmallIcon(R.drawable.ic_stat_mention);
    builder.setTicker(notificationTitle);
    builder.setContentTitle(notificationTitle);
    builder.setContentText(notificationContent);
    builder.setCategory(NotificationCompat.CATEGORY_SOCIAL);
    builder.setContentIntent(getContentIntent(context,AUTHORITY_MENTIONS,accountId));
    builder.setDeleteIntent(getMarkReadDeleteIntent(context,AUTHORITY_MENTIONS,accountId,statusId,following));
    builder.setNumber(statusesCount);
    builder.setWhen(when);
    builder.setStyle(style);
    setNotificationPreferences(builder,pref,pref.getMentionsNotificationType());
    try {
      nm.notify("mentions_" + accountId,NOTIFICATION_ID_MENTIONS_TIMELINE,builder.build());
      Utils.sendPebbleNotification(context,notificationContent);
    }
 catch (    SecurityException e) {
    }
  }
  finally {
    userCursor.close();
  }
}
