{
  final int table_id=getTableId(uri);
  final String table=getTableNameById(table_id);
  final int mode_code;
  if ("r".equals(mode)) {
    mode_code=ParcelFileDescriptor.MODE_READ_ONLY;
  }
 else   if ("rw".equals(mode)) {
    mode_code=ParcelFileDescriptor.MODE_READ_WRITE;
  }
 else   if ("rwt".equals(mode)) {
    mode_code=ParcelFileDescriptor.MODE_READ_WRITE | ParcelFileDescriptor.MODE_TRUNCATE;
  }
 else   throw new IllegalArgumentException();
  if (mode_code == ParcelFileDescriptor.MODE_READ_ONLY) {
    checkReadPermission(table_id,table,null);
  }
 else   if ((mode_code & ParcelFileDescriptor.MODE_READ_WRITE) != 0) {
    checkReadPermission(table_id,table,null);
    checkWritePermission(table_id,table);
  }
switch (table_id) {
case VIRTUAL_TABLE_ID_CACHED_IMAGES:
{
      return getCachedImageFd(uri.getQueryParameter(QUERY_PARAM_URL));
    }
case VIRTUAL_TABLE_ID_CACHE_FILES:
{
    return getCacheFileFd(uri.getLastPathSegment());
  }
}
return null;
}
