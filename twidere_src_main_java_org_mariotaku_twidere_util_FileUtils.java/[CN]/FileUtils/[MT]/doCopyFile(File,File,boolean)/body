{
  if (destFile.exists() && destFile.isDirectory())   throw new IOException("Destination '" + destFile + "' exists but is a directory");
  FileInputStream fis=null;
  FileOutputStream fos=null;
  FileChannel input=null;
  FileChannel output=null;
  try {
    fis=new FileInputStream(srcFile);
    fos=new FileOutputStream(destFile);
    input=fis.getChannel();
    output=fos.getChannel();
    final long size=input.size();
    long pos=0;
    long count;
    while (pos < size) {
      count=size - pos > FILE_COPY_BUFFER_SIZE ? FILE_COPY_BUFFER_SIZE : size - pos;
      pos+=output.transferFrom(input,pos,count);
    }
  }
  finally {
    closeQuietly(output);
    closeQuietly(fos);
    closeQuietly(input);
    closeQuietly(fis);
  }
  if (srcFile.length() != destFile.length())   throw new IOException("Failed to copy full contents from '" + srcFile + "' to '"+ destFile+ "'");
  if (preserveFileDate) {
    destFile.setLastModified(srcFile.lastModified());
  }
}
