{
  if (exception != null)   throw exception;
  if (response == null) {
    if (reachedTimeout()) {
      final SocketTimeoutException exception=new SocketTimeoutException("Request timed out after " + timeout + " ms");
      final HttpEngine httpEngine=RealCallAccessor.getHttpEngine(call.call);
      if (httpEngine != null) {
        httpEngine.streamAllocation.connectionFailed(exception);
      }
      throw exception;
    }
 else {
      throw new IOException("Request cancelled");
    }
  }
  return response;
}
