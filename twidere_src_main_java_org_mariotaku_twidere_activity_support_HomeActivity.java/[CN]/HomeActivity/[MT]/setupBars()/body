{
  final int themeColor=getThemeColor();
  final String backgroundOption=getCurrentThemeBackgroundOption();
  final boolean isTransparent=ThemeUtils.isTransparentBackground(backgroundOption);
  final int actionBarAlpha=isTransparent ? ThemeUtils.getActionBarAlpha(ThemeUtils.getUserThemeBackgroundAlpha(this)) : 0xFF;
  final IHomeActionButton homeActionButton=(IHomeActionButton)mActionsButton;
  mTabIndicator.setItemContext(ThemeUtils.getActionBarThemedContext(this,themeColor));
  ViewSupport.setBackground(mActionBarContainer,ThemeUtils.getActionBarBackground(this,themeColor,backgroundOption,true));
  final int actionBarColor=ThemeUtils.getActionBarColor(this,themeColor,backgroundOption);
  final int actionItemColor=ThemeUtils.getContrastForegroundColor(this,themeColor);
  final int[] foregroundColors=new int[2];
  ThemeUtils.getColorForegroundAndInverse(this,foregroundColors);
  if (ThemeUtils.isDarkTheme(this)) {
    homeActionButton.setButtonColor(actionBarColor);
    homeActionButton.setIconColor(actionItemColor,Mode.SRC_ATOP);
    mTabIndicator.setStripColor(themeColor);
    mTabIndicator.setIconColor(foregroundColors[0]);
    mTabIndicator.setLabelColor(foregroundColors[0]);
  }
 else {
    final int contrastColor=TwidereColorUtils.getContrastYIQ(themeColor,ThemeUtils.ACCENT_COLOR_THRESHOLD,foregroundColors[0],foregroundColors[1]);
    homeActionButton.setButtonColor(themeColor);
    homeActionButton.setIconColor(actionItemColor,Mode.SRC_ATOP);
    mTabIndicator.setStripColor(contrastColor);
    mTabIndicator.setIconColor(contrastColor);
    mTabIndicator.setLabelColor(contrastColor);
  }
  mHomeContent.setDrawColor(true);
  mHomeContent.setDrawShadow(false);
  mHomeContent.setColor(actionBarColor,actionBarAlpha);
  mHomeContent.setFactor(1);
  mActionBarWithOverlay.setAlpha(actionBarAlpha / 255f);
  mActionsButton.setAlpha(actionBarAlpha / 255f);
}
