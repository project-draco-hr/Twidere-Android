{
  setUiOptions(getWindow());
  super.onCreate(savedInstanceState);
  if (!isDatabaseReady(this)) {
    Toast.makeText(this,R.string.preparing_database_toast,Toast.LENGTH_SHORT).show();
    finish();
    return;
  }
  mPreferences=getSharedPreferences(SHARED_PREFERENCES_NAME,Context.MODE_PRIVATE);
  mTwitterWrapper=getTwitterWrapper();
  mNotificationManager=(NotificationManager)getSystemService(NOTIFICATION_SERVICE);
  mMultiSelectHandler=new MultiSelectEventHandler(this);
  mHotKeyHandler=new HotKeyHandler(this);
  mMultiSelectHandler.dispatchOnCreate();
  final Resources res=getResources();
  final boolean displayIcon=res.getBoolean(R.bool.home_display_icon);
  final long[] accountIds=getAccountIds(this);
  if (accountIds.length == 0) {
    final Intent sign_in_intent=new Intent(INTENT_ACTION_TWITTER_LOGIN);
    sign_in_intent.setClass(this,SignInActivity.class);
    startActivity(sign_in_intent);
    finish();
    return;
  }
 else {
    notifyAccountsChanged();
  }
  final Intent intent=getIntent();
  if (openSettingsWizard()) {
    finish();
    return;
  }
  setContentView(R.layout.activity_home);
  sendBroadcast(new Intent(BROADCAST_HOME_ACTIVITY_ONCREATE));
  final boolean refreshOnStart=mPreferences.getBoolean(KEY_REFRESH_ON_START,false);
  mTabDisplayOption=getTabDisplayOptionInt(this);
  final int initialTabPosition=handleIntent(intent,savedInstanceState == null);
  final ActionBar actionBar=getActionBar();
  if (actionBar != null) {
    actionBar.hide();
  }
  ThemeUtils.applyBackground(mTabIndicator);
  mPagerAdapter=new SupportTabsAdapter(this,getSupportFragmentManager(),mTabIndicator,1);
  mViewPager.setAdapter(mPagerAdapter);
  mViewPager.setOffscreenPageLimit(3);
  mTabIndicator.setViewPager(mViewPager);
  mTabIndicator.setOnPageChangeListener(this);
  if (mTabDisplayOption != 0) {
    mTabIndicator.setDisplayLabel((mTabDisplayOption & VALUE_TAB_DIPLAY_OPTION_CODE_LABEL) != 0);
    mTabIndicator.setDisplayIcon((mTabDisplayOption & VALUE_TAB_DIPLAY_OPTION_CODE_ICON) != 0);
  }
 else {
    mTabIndicator.setDisplayLabel(false);
    mTabIndicator.setDisplayIcon(true);
  }
  mActionsButton.setOnClickListener(this);
  mActionsButton.setOnLongClickListener(this);
  initTabs();
  final boolean tabsNotEmpty=mPagerAdapter.getCount() > 0;
  mEmptyTabHint.setVisibility(tabsNotEmpty ? View.GONE : View.VISIBLE);
  mViewPager.setVisibility(tabsNotEmpty ? View.VISIBLE : View.GONE);
  setTabPosition(initialTabPosition);
  setupSlidingMenu();
  showDataProfilingRequest();
  initUnreadCount();
  updateActionsButton();
  updateSmartBar();
  updateSlidingMenuTouchMode();
  if (savedInstanceState == null) {
    if (refreshOnStart) {
      mTwitterWrapper.refreshAll();
    }
    if (intent.getBooleanExtra(EXTRA_OPEN_ACCOUNTS_DRAWER,false)) {
      openAccountsDrawer();
    }
  }
  mPagerPosition=Float.NaN;
  final int themeColor=getThemeColor(), contrastColor=Utils.getContrastYIQ(themeColor,192);
  final int themeResId=getCurrentThemeResourceId();
  if (ThemeUtils.isColoredActionBar(themeResId)) {
    ViewAccessor.setBackground(mTabIndicator,new ColorDrawable(themeColor));
    mTabIndicator.setStripColor(contrastColor);
    mTabIndicator.setIconColor(contrastColor);
  }
 else {
    ViewAccessor.setBackground(mTabIndicator,ThemeUtils.getActionBarBackground(this,themeResId));
    mTabIndicator.setStripColor(themeColor);
    mTabIndicator.setIconColor(ThemeUtils.isLightActionBar(themeResId) ? Color.BLACK : Color.WHITE);
  }
  if (mActionsButton instanceof IHomeActionButton) {
    ((IHomeActionButton)mActionsButton).setColor(themeColor);
  }
  ViewAccessor.setBackground(mActionBarOverlay,ThemeUtils.getWindowContentOverlay(this));
}
