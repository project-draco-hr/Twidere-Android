{
  if (user == null)   throw new TwitterException("Unable to get user info");
  final HttpClientWrapper client=new HttpClientWrapper(conf);
  final String profileImageUrl=ParseUtils.parseString(user.getProfileImageURL());
  final HttpResponse conn=profileImageUrl != null ? client.get(profileImageUrl,null) : null;
  final Bitmap bm=conn != null ? BitmapFactory.decodeStream(conn.asStream()) : null;
  if (bm == null) {
    try {
      final String profileBackgroundColor=user.getProfileBackgroundColor();
      if (isEmpty(profileBackgroundColor))       throw new TwitterException("Can't get profile image");
      return Color.parseColor(profileBackgroundColor);
    }
 catch (    final IllegalArgumentException e) {
      throw new TwitterException("Can't get profile image");
    }
  }
  try {
    return ColorAnalyser.analyse(bm);
  }
  finally {
    bm.recycle();
  }
}
