{
  final String hostName=address.getHostName();
  final String resolvedHost=resolver.resolve(hostName);
  if (resolvedHost != null && !resolvedHost.equals(hostName)) {
    if (InetAddressUtils.isIPv6Address(resolvedHost)) {
      final byte[] resolvedAddress=Inet6Address.getByName(resolvedHost).getAddress();
      return new Socket(InetAddress.getByAddress(hostName,resolvedAddress),port,localAddress,localPort);
    }
 else     if (InetAddressUtils.isIPv4Address(resolvedHost)) {
      final byte[] resolvedAddress=Inet4Address.getByName(resolvedHost).getAddress();
      return new Socket(InetAddress.getByAddress(hostName,resolvedAddress),port,localAddress,localPort);
    }
  }
  return defaultFactory.createSocket(address,port,localAddress,localPort);
}
