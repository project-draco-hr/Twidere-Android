{
  final Context wrapped=ThemeUtils.getDialogThemedContext(getActivity());
  final AlertDialog.Builder builder=new AlertDialog.Builder(wrapped);
  builder.setView(R.layout.dialog_host_mapping);
  builder.setTitle(R.string.add_host_mapping);
  builder.setPositiveButton(android.R.string.ok,this);
  builder.setNegativeButton(android.R.string.cancel,null);
  final AlertDialog dialog=builder.create();
  dialog.setOnShowListener(new OnShowListener(){
    @Override public void onShow(    DialogInterface dialog){
      AlertDialog alertDialog=(AlertDialog)dialog;
      mEditHost=(EditText)alertDialog.findViewById(R.id.host);
      mEditAddress=(EditText)alertDialog.findViewById(R.id.address);
      mCheckExclude=(CheckBox)alertDialog.findViewById(R.id.exclude);
      mEditHost.addTextChangedListener(AddMappingDialogFragment.this);
      mEditAddress.addTextChangedListener(AddMappingDialogFragment.this);
      mCheckExclude.setOnCheckedChangeListener(AddMappingDialogFragment.this);
      final Bundle args=getArguments();
      if (args != null) {
        mEditHost.setEnabled(!args.getBoolean(EXTRA_EDIT_MODE,false));
        if (savedInstanceState == null) {
          mEditHost.setText(args.getCharSequence(EXTRA_HOST));
          mEditAddress.setText(args.getCharSequence(EXTRA_ADDRESS));
          mCheckExclude.setChecked(args.getBoolean(EXTRA_EXCLUDED));
        }
      }
      updateButton();
    }
  }
);
  return dialog;
}
