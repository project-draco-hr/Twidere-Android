{
  final StatusFragment fragment=adapter.getFragment();
  final ParcelableStatus status=adapter.getStatus(getPosition());
  if (status == null || fragment == null)   return false;
  final AsyncTwitterWrapper twitter=fragment.getTwitterWrapper();
  final FragmentActivity activity=fragment.getActivity();
switch (item.getItemId()) {
case MENU_SHARE:
{
      startStatusShareChooser(activity,status);
      break;
    }
case MENU_COPY:
{
    if (ClipboardUtils.setText(activity,status.text_plain)) {
      showOkMessage(activity,R.string.text_copied,false);
    }
    break;
  }
case MENU_RETWEET:
{
  if (isMyRetweet(status)) {
    cancelRetweet(twitter,status);
  }
 else {
    final long id_to_retweet=status.is_retweet && status.retweet_id > 0 ? status.retweet_id : status.id;
    twitter.retweetStatus(status.account_id,id_to_retweet);
  }
  break;
}
case MENU_QUOTE:
{
final Intent intent=new Intent(INTENT_ACTION_QUOTE);
intent.putExtra(EXTRA_STATUS,status);
fragment.startActivity(intent);
break;
}
case MENU_REPLY:
{
final Intent intent=new Intent(INTENT_ACTION_REPLY);
intent.putExtra(EXTRA_STATUS,status);
fragment.startActivity(intent);
break;
}
case MENU_FAVORITE:
{
if (status.is_favorite) {
twitter.destroyFavoriteAsync(status.account_id,status.id);
}
 else {
twitter.createFavoriteAsync(status.account_id,status.id);
}
break;
}
case MENU_DELETE:
{
DestroyStatusDialogFragment.show(fragment.getFragmentManager(),status);
break;
}
case MENU_ADD_TO_FILTER:
{
AddStatusFilterDialogFragment.show(fragment.getFragmentManager(),status);
break;
}
case MENU_SET_COLOR:
{
final Intent intent=new Intent(activity,ColorPickerDialogActivity.class);
final int color=getUserColor(activity,status.user_id,true);
if (color != 0) {
intent.putExtra(EXTRA_COLOR,color);
}
intent.putExtra(EXTRA_CLEAR_BUTTON,color != 0);
intent.putExtra(EXTRA_ALPHA_SLIDER,false);
fragment.startActivityForResult(intent,REQUEST_SET_COLOR);
break;
}
case MENU_CLEAR_NICKNAME:
{
clearUserNickname(activity,status.user_id);
adapter.notifyDataSetChanged();
break;
}
case MENU_SET_NICKNAME:
{
final String nick=getUserNickname(activity,status.user_id,true);
SetUserNicknameDialogFragment.show(fragment.getFragmentManager(),status.user_id,nick);
break;
}
case MENU_TRANSLATE:
{
final ParcelableAccountWithCredentials account=ParcelableAccount.getAccountWithCredentials(activity,status.account_id);
if (ParcelableAccountWithCredentials.isOfficialCredentials(activity,account)) {
StatusTranslateDialogFragment.show(fragment.getFragmentManager(),status);
}
 else {
}
break;
}
case MENU_OPEN_WITH_ACCOUNT:
{
final Intent intent=new Intent(INTENT_ACTION_SELECT_ACCOUNT);
intent.setClass(activity,AccountSelectorActivity.class);
intent.putExtra(EXTRA_SINGLE_SELECTION,true);
fragment.startActivityForResult(intent,REQUEST_SELECT_ACCOUNT);
break;
}
default :
{
if (item.getIntent() != null) {
try {
fragment.startActivity(item.getIntent());
}
 catch (final ActivityNotFoundException e) {
Log.w(LOGTAG,e);
return false;
}
}
break;
}
}
return true;
}
