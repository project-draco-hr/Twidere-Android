{
  final SignInActivity activity=activityRef.get();
  if (activity == null)   return new SignInResponse(false,false,null);
  Endpoint endpoint=TwitterAPIFactory.getOAuthSignInEndpoint(apiUrlFormat,sameOAuthSigningUrl);
  OAuthAuthorization auth=new OAuthAuthorization(consumerKey.getOauthToken(),consumerKey.getOauthTokenSecret());
  final TwitterOAuth oauth=TwitterAPIFactory.getInstance(activity,endpoint,auth,TwitterOAuth.class);
  final OAuthPasswordAuthenticator authenticator=new OAuthPasswordAuthenticator(oauth,verificationCallback,userAgent);
  final OAuthToken accessToken=authenticator.getOAuthAccessToken(username,password);
  final String userId=accessToken.getUserId();
  if (userId == null)   return new SignInResponse(false,false,null);
  return getOAuthSignInResponse(activity,accessToken,userId,ParcelableCredentials.AuthType.OAUTH);
}
