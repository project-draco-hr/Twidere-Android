{
  if (directMessage == null || directMessage.getId() <= 0)   return;
  for (  final Uri uri : MESSAGES_URIS) {
    final String where=DirectMessages.ACCOUNT_KEY + " = " + account.account_key+ " AND "+ DirectMessages.MESSAGE_ID+ " = "+ directMessage.getId();
    resolver.delete(uri,where,null);
  }
  final User sender=directMessage.getSender(), recipient=directMessage.getRecipient();
  if (sender.getId() == account.account_key) {
    final ContentValues values=ContentValuesCreator.createDirectMessage(directMessage,account.account_key,account.account_host,true);
    if (values != null) {
      resolver.insert(DirectMessages.Outbox.CONTENT_URI,values);
    }
  }
  if (recipient.getId() == account.account_key) {
    final ContentValues values=ContentValuesCreator.createDirectMessage(directMessage,account.account_key,account.account_host,false);
    final Uri.Builder builder=DirectMessages.Inbox.CONTENT_URI.buildUpon();
    builder.appendQueryParameter(QUERY_PARAM_NOTIFY,"true");
    if (values != null) {
      resolver.insert(builder.build(),values);
    }
  }
}
