{
  final SharedPreferencesWrapper preferences=context.mPreferences;
  final boolean attachLocation=preferences.getBoolean(KEY_ATTACH_LOCATION);
  final boolean attachPreciseLocation=preferences.getBoolean(KEY_ATTACH_PRECISE_LOCATION);
  if (attachLocation) {
    if (attachPreciseLocation) {
      final ParcelableLocation location=getParams();
      textView.setText(ParcelableLocationUtils.getHumanReadableString(location,3));
      textView.setTag(location);
    }
 else     if (addresses == null || addresses.isEmpty()) {
      Object tag=textView.getTag();
      if (tag instanceof Address) {
        textView.setText(((Address)tag).getLocality());
      }
 else {
        textView.setText(R.string.your_coarse_location);
        textView.setTag(new NoAddress());
      }
    }
 else {
      final Address address=addresses.get(0);
      textView.setTag(address);
      textView.setText(address.getLocality());
    }
  }
 else {
    textView.setText(R.string.no_location);
  }
}
