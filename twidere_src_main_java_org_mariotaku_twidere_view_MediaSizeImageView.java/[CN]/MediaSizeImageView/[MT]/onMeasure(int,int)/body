{
  if (mMediaWidth == 0 || mMediaHeight == 0) {
    super.onMeasure(widthMeasureSpec,heightMeasureSpec);
    return;
  }
  final float whRatio=(float)mMediaWidth / mMediaHeight;
  final int width=MeasureSpec.getSize(widthMeasureSpec), height=MeasureSpec.getSize(heightMeasureSpec);
  final ViewGroup.LayoutParams lp=getLayoutParams();
  if (lp.height == ViewGroup.LayoutParams.MATCH_PARENT && lp.width == ViewGroup.LayoutParams.WRAP_CONTENT) {
    final int calcWidth=Math.round(height * whRatio);
    super.onMeasure(MeasureSpec.makeMeasureSpec(calcWidth,MeasureSpec.EXACTLY),heightMeasureSpec);
    setMeasuredDimension(calcWidth,height);
  }
 else   if (lp.width == ViewGroup.LayoutParams.MATCH_PARENT && lp.height == ViewGroup.LayoutParams.WRAP_CONTENT) {
    final int calcHeight=Math.round(width / whRatio);
    super.onMeasure(widthMeasureSpec,MeasureSpec.makeMeasureSpec(calcHeight,MeasureSpec.EXACTLY));
    setMeasuredDimension(width,calcHeight);
  }
 else {
    super.onMeasure(widthMeasureSpec,heightMeasureSpec);
  }
}
