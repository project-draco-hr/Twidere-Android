{
  if (context == null && source == null)   return null;
  try {
    final String name=source.getName();
    if (isEmpty(name))     return null;
    final MimeTypeMap map=MimeTypeMap.getSingleton();
    final String extension=map.getExtensionFromMimeType(mimeType);
    if (extension == null)     return null;
    final String nameToSave=name.contains(".") ? name : name + "." + extension;
    if (!destination.isDirectory() && !destination.mkdirs())     return null;
    final File saveFile=new File(destination,nameToSave);
    FileUtils.copyFile(source,saveFile);
    if (mimeType != null) {
      MediaScannerConnection.scanFile(context,new String[]{saveFile.getPath()},new String[]{mimeType},null);
    }
    return saveFile;
  }
 catch (  final IOException e) {
    Log.w(LOGTAG,"Failed to save file",e);
    return null;
  }
}
