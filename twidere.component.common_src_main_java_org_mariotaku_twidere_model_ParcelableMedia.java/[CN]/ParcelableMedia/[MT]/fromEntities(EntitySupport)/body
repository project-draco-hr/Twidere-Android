{
  final List<ParcelableMedia> list=new ArrayList<>();
  final MediaEntity[] mediaEntities;
  if (entities instanceof ExtendedEntitySupport) {
    final ExtendedEntitySupport extendedEntities=(ExtendedEntitySupport)entities;
    final MediaEntity[] extendedMediaEntities=extendedEntities.getExtendedMediaEntities();
    mediaEntities=extendedMediaEntities != null ? extendedMediaEntities : entities.getMediaEntities();
  }
 else {
    mediaEntities=entities.getMediaEntities();
  }
  if (mediaEntities != null) {
    for (    final MediaEntity media : mediaEntities) {
      final URL mediaURL=media.getMediaURL();
      if (mediaURL != null) {
        list.add(new ParcelableMedia(media));
      }
    }
  }
  final URLEntity[] urlEntities=entities.getURLEntities();
  if (urlEntities != null) {
    for (    final URLEntity url : urlEntities) {
      final String expanded=ParseUtils.parseString(url.getExpandedURL());
      final String media_url=MediaPreviewUtils.getSupportedLink(expanded);
      if (expanded != null && media_url != null) {
        list.add(new ParcelableMedia(expanded,media_url,url.getStart(),url.getEnd(),TYPE_IMAGE));
      }
    }
  }
  if (list.isEmpty())   return null;
  return list.toArray(new ParcelableMedia[list.size()]);
}
