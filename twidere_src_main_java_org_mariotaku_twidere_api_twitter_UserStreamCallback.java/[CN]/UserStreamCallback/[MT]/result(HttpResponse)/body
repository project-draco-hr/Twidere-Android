{
  if (!response.isSuccessful()) {
    final TwitterException cause=new TwitterException();
    cause.setHttpResponse(response);
    onException(cause);
    return;
  }
  final JacksonJrSimpleTreeCodec mapper=new JacksonJrSimpleTreeCodec();
  final CRLFLineReader reader=new CRLFLineReader(new InputStreamReader(response.getBody().stream(),"UTF-8"));
  try {
    for (String line; (line=reader.readLine()) != null && !disconnected; ) {
      if (!connected) {
        onConnected();
        connected=true;
      }
      if (line.isEmpty())       continue;
      TreeNode rootNode=mapper.readTree(LoganSquare.JSON_FACTORY.createParser(line));
switch (JSONObjectType.determine(rootNode)) {
case SENDER:
{
          break;
        }
case STATUS:
{
        onStatus(LoganSquareMapperFinder.mapperFor(Status.class).parse(rootNode.traverse()));
        break;
      }
case DIRECT_MESSAGE:
{
      onDirectMessage(LoganSquareMapperFinder.mapperFor(DirectMessage.class).parse(rootNode.traverse()));
      break;
    }
case DELETE:
{
    break;
  }
case LIMIT:
break;
case STALL_WARNING:
break;
case SCRUB_GEO:
break;
case FRIENDS:
break;
case FAVORITE:
{
onFavorite(parse(User.class,rootNode.get("source")),parse(User.class,rootNode.get("target")),parse(Status.class,rootNode.get("target_object")));
break;
}
case UNFAVORITE:
{
onUnfavorite(parse(User.class,rootNode.get("source")),parse(User.class,rootNode.get("target")),parse(Status.class,rootNode.get("target_object")));
break;
}
case FOLLOW:
break;
case UNFOLLOW:
break;
case USER_LIST_MEMBER_ADDED:
break;
case USER_LIST_MEMBER_DELETED:
break;
case USER_LIST_SUBSCRIBED:
break;
case USER_LIST_UNSUBSCRIBED:
break;
case USER_LIST_CREATED:
break;
case USER_LIST_UPDATED:
break;
case USER_LIST_DESTROYED:
break;
case USER_UPDATE:
break;
case USER_DELETE:
break;
case USER_SUSPEND:
break;
case BLOCK:
break;
case UNBLOCK:
break;
case DISCONNECTION:
break;
case UNKNOWN:
break;
}
}
}
 catch (IOException e) {
onException(e);
}
 finally {
Log.d("Twidere.Stream","Cleaning up...");
reader.close();
response.close();
}
}
