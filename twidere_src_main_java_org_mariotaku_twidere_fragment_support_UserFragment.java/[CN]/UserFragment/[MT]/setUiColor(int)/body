{
  mUiColor=color;
  mPreviousActionBarItemIsDark=0;
  mPreviousTabItemIsDark=0;
  if (mActionBarBackground == null) {
    setupBaseActionBar();
  }
  final AppCompatActivity activity=(AppCompatActivity)getActivity();
  final IThemedActivity themed=(IThemedActivity)activity;
  final int themeRes=themed.getCurrentThemeResourceId();
  final String backgroundOption=themed.getThemeBackgroundOption();
  final int actionBarColor=ThemeUtils.getActionBarColor(activity,color,themeRes,backgroundOption);
  if (mTintedStatusContent != null) {
    final int alpha=ThemeUtils.isTransparentBackground(backgroundOption) ? themed.getCurrentThemeBackgroundAlpha() : 0xFF;
    mTintedStatusContent.setColor(actionBarColor,ThemeUtils.getActionBarAlpha(alpha));
  }
  if (mActionBarBackground != null) {
    mActionBarBackground.setColor(actionBarColor);
  }
  if (mUser != null) {
    final String displayName=mUserColorNameManager.getDisplayName(mUser,mNameFirst,false);
    ActivitySupport.setTaskDescription(activity,new TaskDescriptionCompat(displayName,null,actionBarColor));
  }
 else {
    ActivitySupport.setTaskDescription(activity,new TaskDescriptionCompat(null,null,actionBarColor));
  }
  final int optimalAccentColor=ThemeUtils.getOptimalAccentColor(color,mDescriptionView.getCurrentTextColor());
  mDescriptionView.setLinkTextColor(optimalAccentColor);
  mLocationView.setLinkTextColor(optimalAccentColor);
  mURLView.setLinkTextColor(optimalAccentColor);
  mProfileBannerView.setBackgroundColor(color);
  ViewSupport.setBackground(mPagerIndicator,ThemeUtils.getActionBarStackedBackground(activity,themeRes,optimalAccentColor,backgroundOption,true));
  final HeaderDrawerLayout drawer=mHeaderDrawerLayout;
  if (drawer != null) {
    final int offset=drawer.getPaddingTop() - drawer.getHeaderTop();
    updateScrollOffset(offset);
  }
}
