{
  final OkHttpClient client=new OkHttpClient();
  final boolean ignoreSSLError=conf.isSSLErrorIgnored();
  client.setHostnameVerifier(new HostResolvedHostnameVerifier(ignoreSSLError));
  client.setSslSocketFactory(new HostResolvedSSLSocketFactory(resolver,ignoreSSLError));
  client.setSocketFactory(new HostResolvedSocketFactory(resolver));
  if (conf.isProxyConfigured()) {
    client.setProxy(new Proxy(Type.HTTP,InetSocketAddress.createUnresolved(conf.getHttpProxyHost(),conf.getHttpProxyPort())));
  }
  return client;
}
