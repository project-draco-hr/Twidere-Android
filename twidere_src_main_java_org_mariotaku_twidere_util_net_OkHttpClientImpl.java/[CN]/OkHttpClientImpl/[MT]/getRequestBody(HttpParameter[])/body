{
  if (params == null)   return null;
  if (!HttpParameter.containsFile(params)) {
    return RequestBody.create(APPLICATION_FORM_URLENCODED,HttpParameter.encodeParameters(params));
  }
  final MultipartBuilder builder=new MultipartBuilder();
  for (  final HttpParameter param : params) {
    if (param.isFile()) {
      RequestBody requestBody;
      if (param.hasFileBody()) {
        final ByteArrayOutputStream os=new ByteArrayOutputStream();
        Utils.copyStream(param.getFileBody(),os);
        requestBody=RequestBody.create(MediaType.parse(param.getContentType()),os.toByteArray());
        os.close();
      }
 else {
        requestBody=RequestBody.create(MediaType.parse(param.getContentType()),param.getFile());
      }
      builder.addFormDataPart(param.getName(),param.getFileName(),requestBody);
    }
 else {
      builder.addFormDataPart(param.getName(),param.getValue());
    }
  }
  return builder.build();
}
