{
  mMessagesListView.removeOnScrollListener(mScrollListener);
  mBus.unregister(this);
  if (mPopupMenu != null) {
    mPopupMenu.dismiss();
  }
  final ParcelableCredentials account=mAccount;
  final ParcelableUser recipient=mRecipient;
  if (account != null && recipient != null) {
    final String key=getDraftsTextKey(account.account_key,recipient.key);
    final SharedPreferences.Editor editor=mMessageDrafts.edit();
    final String text=ParseUtils.parseString(mEditText.getText());
    if (TextUtils.isEmpty(text)) {
      editor.remove(key);
    }
 else {
      editor.putString(key,text);
    }
    editor.apply();
  }
  super.onStop();
}
