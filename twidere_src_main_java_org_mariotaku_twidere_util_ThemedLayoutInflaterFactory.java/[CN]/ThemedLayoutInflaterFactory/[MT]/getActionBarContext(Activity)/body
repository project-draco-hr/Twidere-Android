{
  if (activity instanceof AppCompatActivity) {
    final AppCompatDelegate delegate=((AppCompatActivity)activity).getDelegate();
    final ActionBar actionBar=AppCompatDelegateTrojan.peekActionBar(delegate);
    if (actionBar instanceof WindowDecorActionBar)     return actionBar.getThemedContext();
  }
 else   if (activity instanceof AppCompatPreferenceActivity) {
    final AppCompatDelegate delegate=((AppCompatPreferenceActivity)activity).getDelegate();
    final ActionBar actionBar=AppCompatDelegateTrojan.peekActionBar(delegate);
    if (actionBar instanceof WindowDecorActionBar)     return actionBar.getThemedContext();
  }
 else {
    final android.app.ActionBar actionBar=activity.getActionBar();
    if (actionBar != null)     return actionBar.getThemedContext();
  }
  return null;
}
