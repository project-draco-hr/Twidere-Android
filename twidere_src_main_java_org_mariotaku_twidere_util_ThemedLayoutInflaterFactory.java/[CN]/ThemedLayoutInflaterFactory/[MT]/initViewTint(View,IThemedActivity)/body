{
  final int noTintColor, tintColor;
  final boolean isColorTint;
  final boolean isActionBarContext=isActionBarContext(view.getContext(),getActionBarContext((Activity)activity));
  if (!isActionBarContext) {
    tintColor=activity.getCurrentThemeColor();
    noTintColor=TwidereColorUtils.getContrastYIQ(tintColor,ThemeUtils.ACCENT_COLOR_THRESHOLD);
    isColorTint=true;
  }
 else   if (ThemeUtils.isDarkTheme(activity.getCurrentThemeResourceId())) {
    noTintColor=Color.WHITE;
    tintColor=activity.getCurrentThemeColor();
    isColorTint=true;
  }
 else {
    final int themeColor=activity.getCurrentThemeColor();
    tintColor=TwidereColorUtils.getContrastYIQ(themeColor,ThemeUtils.ACCENT_COLOR_THRESHOLD);
    noTintColor=TwidereColorUtils.getContrastYIQ(tintColor,ThemeUtils.ACCENT_COLOR_THRESHOLD);
    isColorTint=false;
  }
  if (view instanceof TextView) {
    final TextView textView=(TextView)view;
    textView.setLinkTextColor(tintColor);
  }
  if (view instanceof IThemedView) {
    ((IThemedView)view).setThemeTintColor(ColorStateList.valueOf(tintColor));
  }
 else   if (view instanceof TintableBackgroundView) {
    final TintableBackgroundView tintable=(TintableBackgroundView)view;
    if (view instanceof Button) {
    }
 else     if (view instanceof EditText) {
      tintable.setSupportBackgroundTintList(ColorStateList.valueOf(tintColor));
    }
 else {
      if (isColorTint) {
        final int[][] states={{android.R.attr.state_selected},{android.R.attr.state_focused},{android.R.attr.state_pressed},{0}};
        final int[] colors={tintColor,tintColor,tintColor,noTintColor};
        tintable.setSupportBackgroundTintList(new ColorStateList(states,colors));
      }
 else {
        tintable.setSupportBackgroundTintList(ColorStateList.valueOf(tintColor));
      }
    }
  }
 else   if (view instanceof EditText) {
    ViewCompat.setBackgroundTintList(view,ColorStateList.valueOf(tintColor));
  }
}
