{
  final XmlPullParserFactory f=XmlPullParserFactory.newInstance();
  final XmlPullParser parser=f.newPullParser();
  parser.setFeature(Xml.FEATURE_RELAXED,true);
  parser.setInput(in);
  while (parser.next() != XmlPullParser.END_DOCUMENT) {
    final String tag=parser.getName();
switch (parser.getEventType()) {
case XmlPullParser.START_TAG:
{
        if ("input".equals(tag) && "authenticity_token".equals(parser.getAttributeValue(null,"name")))         return parser.getAttributeValue(null,"value");
      }
  }
}
return null;
}
