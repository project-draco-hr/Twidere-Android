{
  HttpResponse response=null;
  try {
    final AuthorizeRequestData data=new AuthorizeRequestData();
    final HttpRequest.Builder authorizePageBuilder=new HttpRequest.Builder();
    authorizePageBuilder.method(GET.METHOD);
    authorizePageBuilder.url(endpoint.construct("/oauth/authorize",new String[]{"oauth_token",requestToken.getOauthToken()}));
    data.referer=Endpoint.constructUrl("https://api.twitter.com/oauth/authorize",new String[]{"oauth_token",requestToken.getOauthToken()});
    final MultiValueMap<String> requestHeaders=new MultiValueMap<>();
    requestHeaders.add("User-Agent",userAgent);
    authorizePageBuilder.headers(requestHeaders);
    authorizePageBuilder.tag(RequestType.API);
    final HttpRequest authorizePageRequest=authorizePageBuilder.build();
    response=client.newCall(authorizePageRequest).execute();
    parseAuthorizeRequestData(response,data);
    if (TextUtils.isEmpty(data.authenticityToken)) {
      throw new AuthenticationException();
    }
    return data;
  }
 catch (  AttoParseException e) {
    throw new AuthenticationException("Malformed HTML",e);
  }
 finally {
    Utils.closeSilently(response);
  }
}
