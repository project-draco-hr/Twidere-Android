{
  final OAuthToken requestToken;
  try {
    requestToken=oauth.getRequestToken(OAUTH_CALLBACK_OOB);
  }
 catch (  final TwitterException e) {
    if (e.isCausedByNetworkIssue())     throw new AuthenticationException(e);
    throw new AuthenticityTokenException(e);
  }
  try {
    final AuthorizeRequestData authorizeRequestData=getAuthorizeRequestData(requestToken);
    AuthorizeResponseData authorizeResponseData=getAuthorizeResponseData(requestToken,authorizeRequestData,username,password);
    if (!TextUtils.isEmpty(authorizeResponseData.oauthPin)) {
      return oauth.getAccessToken(requestToken,authorizeResponseData.oauthPin);
    }
 else     if (authorizeResponseData.verification == null) {
      throw new WrongUserPassException();
    }
    final AuthorizeRequestData verificationData=getVerificationData(authorizeResponseData,loginVerificationCallback.getLoginVerification());
    authorizeResponseData=getAuthorizeResponseData(requestToken,verificationData,username,password);
    if (TextUtils.isEmpty(authorizeResponseData.oauthPin)) {
      throw new VerificationCodeException();
    }
    return oauth.getAccessToken(requestToken,authorizeResponseData.oauthPin);
  }
 catch (  final IOException|NullPointerException|TwitterException e) {
    throw new AuthenticationException(e);
  }
}
