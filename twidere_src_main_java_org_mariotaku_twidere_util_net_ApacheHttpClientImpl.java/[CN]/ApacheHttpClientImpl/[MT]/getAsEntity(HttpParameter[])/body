{
  if (params == null)   return null;
  if (!HttpParameter.containsFile(params))   return new HttpParameterFormEntity(params);
  final MultipartEntityBuilder me=MultipartEntityBuilder.create();
  for (  final HttpParameter param : params) {
    if (param.isFile()) {
      final ContentType contentType=ContentType.create(param.getContentType());
      final ContentBody body;
      if (param.getFile() != null) {
        body=new FileBody(param.getFile(),ContentType.create(param.getContentType()));
      }
 else {
        body=new InputStreamBody(param.getFileBody(),contentType,param.getFileName());
      }
      me.addPart(param.getName(),body);
    }
 else {
      final ContentType contentType=ContentType.TEXT_PLAIN.withCharset(Consts.UTF_8);
      final ContentBody body=new StringBody(param.getValue(),contentType);
      me.addPart(param.getName(),body);
    }
  }
  return me.build();
}
