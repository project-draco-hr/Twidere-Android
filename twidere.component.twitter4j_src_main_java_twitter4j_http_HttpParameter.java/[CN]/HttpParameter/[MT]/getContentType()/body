{
  if (!isFile())   throw new IllegalStateException("not a file");
  if (overrideFileType != null)   return overrideFileType;
  String contentType;
  String extensions=getFileName();
  final int index=extensions.lastIndexOf(".");
  if (-1 == index) {
    contentType=OCTET;
  }
 else {
    extensions=extensions.substring(extensions.lastIndexOf(".") + 1).toLowerCase(Locale.US);
    if (extensions.length() == 3) {
      if ("gif".equals(extensions)) {
        contentType=GIF;
      }
 else       if ("png".equals(extensions)) {
        contentType=PNG;
      }
 else       if ("jpg".equals(extensions)) {
        contentType=JPEG;
      }
 else {
        contentType=OCTET;
      }
    }
 else     if (extensions.length() == 4) {
      if ("jpeg".equals(extensions)) {
        contentType=JPEG;
      }
 else {
        contentType=OCTET;
      }
    }
 else {
      contentType=OCTET;
    }
  }
  return contentType;
}
