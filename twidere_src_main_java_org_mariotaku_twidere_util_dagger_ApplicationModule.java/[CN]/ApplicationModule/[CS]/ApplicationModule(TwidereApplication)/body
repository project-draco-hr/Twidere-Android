{
  if (Thread.currentThread() != Looper.getMainLooper().getThread()) {
    throw new RuntimeException("Module must be created inside main thread");
  }
  sharedPreferences=SharedPreferencesWrapper.getInstance(application,Constants.SHARED_PREFERENCES_NAME,Context.MODE_PRIVATE,SharedPreferenceConstants.class);
  if (sharedPreferences == null) {
    throw new RuntimeException("SharedPreferences must not be null");
  }
  activityTracker=new ActivityTracker();
  bus=new Bus(ThreadEnforcer.MAIN);
  asyncTaskManager=AsyncTaskManager.getInstance();
  readStateManager=new ReadStateManager(application);
  dns=new TwidereDns(application);
  notificationManagerWrapper=new NotificationManagerWrapper(application);
  restHttpClient=TwitterAPIFactory.getDefaultHttpClient(application,dns);
  imageDownloader=new TwidereImageDownloader(application,restHttpClient,true);
  imageLoader=createImageLoader(application,imageDownloader);
  videoLoader=new VideoLoader(application,restHttpClient,asyncTaskManager,bus);
  mediaLoaderWrapper=new MediaLoaderWrapper(imageLoader,videoLoader);
  multiSelectManager=new MultiSelectManager();
  userColorNameManager=new UserColorNameManager(application);
  keyboardShortcutsHandler=new KeyboardShortcutsHandler(application);
  hotMobiLogger=new HotMobiLogger(application);
  asyncTwitterWrapper=new AsyncTwitterWrapper(application,asyncTaskManager,sharedPreferences,bus,userColorNameManager);
  externalThemeManager=new ExternalThemeManager(application,sharedPreferences);
}
